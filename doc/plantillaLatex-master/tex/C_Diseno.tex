\apendice{Especificación de diseño}

\section{Introducción}

A continuación, se incluye una explicación/descripción del diseño de la aplicación Android. Para ello se dividirán los diagramas en dos enfoques: el APIREST utilizado para comunicarse con el proyecto de partida y la propia app Android que se comunicará con dicho API para la obtención y volcado de los datos.

\section{Diseño de datos}

En este apartado se incluirán los diagramas de clases y paquetes de ambos enfoques.

\subsection{Diagrama de clases}

En estos diagramas se ha decidido utilizar un criterio de color para diferenciar aquellas clases que forman parte del APIREST, en color azul y en amarillo aquellos que forman parte del proyecto de partida.

\subsubsection{APIREST}

Este paquete será el encargado de comunicarse con el Controlador del proyecto de partida. A continuación, se mostrarán de manera fraccionada cada una de las clases que lo forman y con qué clases del controlador del proyecto de partida se comunican.

\paragraph{Clase ControlAccesoProfesor}

Esta clase será la encargada de realizar el control de acceso por parte de los profesores a la web QuickTest. Esta web provee a los profesores de una clave privada dentro de la aplicación para poder utilizarla en la sincronización de sus cuestionarios con Moodle. Esta clase permite registrar a un nuevo profesor o comprobar si puede iniciar sesión. Ambas lógicas se controlan mediante una petición post. Para llevar a cabo este cometido se comunican con el controlador llamando al método registrarNuevoUsuario o login respectivamente.

\begin{itemize}

	\item \textbf{Post:} petición que permitirá logearse o registrarse en QuickTest. Para logearse \url{http://localhost/_QuickTest_TFG/app/apiREST/controlAccesoProfesor/login}. Para registrarse \url{http://localhost/_QuickTest_TFG/app/apiREST/controlAccesoProfesor/registro}.
	
\end{itemize}

\imagen{ControlAccesoProfesor}{Clase ControlAccesoProfesor}

\paragraph{Clase GestionCuestionario}

La lógica de esta clase será toda aquella que se encuentre relacionada con la gestión sobre los Cuestionarios: insertar, obtener, duplicar o borrar. Cabe destacar, que en el controlador del proyecto de partida se ha incluido un método para poder duplicar un cuestionario existente, de esta manera evitamos comunicarnos con el modelo.
Para ello se comunica con el controlador. Todas estas acciones se realizan mediante diferentes peticiones:

\begin{itemize}

	\item \textbf{Get:} esta petición será la encargada de mostrar aquellos cuestionarios dada un identificador de asignatura. \url{http://localhost/_QuickTest_TFG/app/apiREST/gestionCuestionario/id}
	\item \textbf{Post:} esta petición maneja dos lógicas: duplicar o insertar/editar un cuestionario. Para duplicar un cuestionario basta con indicar el identificador de cuestionario y para insertar o editar será necesario incluir en esta petición el resto de información propia de un cuestionario. Cabe destacar que el método insertar manejará la lógica de insertar o editar un cuestionario en función de si un campo se encuentra a verdadero o falso. Esta lógica venia dado por el proyecto de partida. Para duplicar un cuestionario \url{http://localhost/_QuickTest_TFG/app/apiREST/gestionCuestionario/duplicar/id}. \linebreak Para insertar/editar un cuestionario \url{http://localhost/_QuickTest_TFG/app/apiREST/gestionCuestionario/insertar}.
	
	\item \textbf{Delete:} esta petición se encarga de eliminar un determinado cuestionario dado un identificador. \url{http://localhost/_QuickTest_TFG/app/apiREST/gestionCuestionario/id}.

\end{itemize}

\imagen{GestionCuestionario}{Clase GestionCuestionario}

\paragraph{Clase SolucionCuestionario}

Esta clase se encarga de la lógica a realizar durante la resolución de un cuestionario: \emph{finalizar o mostrar resultado}.
Todas estas acciones se realizan mediante las siguientes peticiones:

\begin{itemize}

	\item \textbf{Post:} esta petición será la encargada de manejar la lógica a seguir al finalizar un cuestionario. Para ello, obtendrá el contenido del cuestionario resuelto de la petición y almacenará las respuestas del alumno y la nota del mismo. \url{http://localhost/_QuickTest_TFG/app/apiREST/solucionCuestionario/finalizar}.
	
	\item \textbf{Get:} esta petición sera la encargada de obtener la calificación de un alumno que haya resuelto el cuestionario desde la aplicación Android. Para ello, será necesario incluir en la propia petición el identificador del alumno y del cuestionario respectivamente. \url{http://localhost/_QuickTest_TFG/app/apiREST/solucionCuestionario/obtenerNota/idAlumno/idCuestionario}
\end{itemize}

\imagen{SolucionCuestionario}{Clase SolucionCuestionario}

\paragraph{Clase ObtenerCuestionario}

Esta clase se encarga de: la obtención de las preguntas y respuestas que forman un cuestionario, así como que preguntas tienen o no comodín y al finalizar un cuestionario, obtener información acerca de como ha sido resuelto el mismo. Destacar que en el controlador no existe ningún método que permita obtener un cuestionario por identificador y el estado del mismo. Es por esto que esta funcionalidad ha sido incluida dentro del propio API. Además, ha sido necesario incluir dentro de este la funcionalidad de obtener los comodines verdes, ámbar y la información sobre como ha sido resuelto el cuestionario, ya que los métodos que se encuentran en el controlador corrompen la respuesta al incluir volcados del contenido.

\begin{itemize}

	\item \textbf{Get:} esta petición sera la encargada de manejar toda la lógica de la clase.
	\begin{list}{-}
		\item \emph{Obtener cuestionario:} para ello sera necesario incluir en la propia petición el identificador del cuestionario. La petición es la siguiente: \url{http://localhost/_QuickTest_TFG/app/apiREST/obtenerCuestionario/obtener/idCuestionario}.
		
		\item \emph{Obtener el estado de un cuestionario:} es decir, si el cuestionario se encuentra resuelto o no por dicho alumno. Para ello, sera necesarios incluir en la propia petición el identificador del alumno y el identificador de cuestionario. La petición es la siguiente:   \url{http://localhost/_QuickTest_TFG/app/apiREST/obtenerCuestionario/estado/idAlumno/idCuestionario}.
		
		\item \emph{Obtener comodín verde}: es decir, permite obtener aquella preguntas que tienen comodín verde, dado un cuestionario. Para ello es necesario incluir en la propia petición el identificador del cuestionario. La petición es la siguiente:\url{http://localhost/_QuickTest_TFG/app/apiREST/obtenerCuestionario/obtenerComodin/verde/idCuestionario}.
		
		\item \emph{Obtener comodín ámbar}: es decir, permite obtener aquella preguntas que tienen comodín ámbar, dado un cuestionario. Para ello es necesario incluir en la propia petición el identificador del cuestionario. La petición es la siguiente:\url{http://localhost/_QuickTest_TFG/app/apiREST/obtenerCuestionario/obtenerComodin/ambar/idCuestionario}.
		
		\item \emph{Obtener información sobre un cuestionario resuelto}: nos permite obtener información sobre somo ha sido resuelto un cuestionario, es decir, en que grupo se encuentra, cuantos comodines a utilizado, etc. Para ello es necesario incluir en la propia petición el identificador de cuestionario y alumno. La petición es la siguiente: \url{http://localhost/_QuickTest_TFG/app/apiREST/obtenerCuestionario/feedback/idCuestionario/idAlumno}.
	
	\end{list}

\end{itemize}

\imagen{ObtenerCuestionario}{Clase ObtenerCuestionario}


\subsubsection{Android}


\section{Diagrama de paquetes}

Para estos diagramas se ha decido utilizar el mismo criterio de color empleando anteriormente en el diagrama de clases.

\subsection{APIREST}

Este diagrama muestra un desglose de todos los componentes que entran en contacto en el API, como ya se ha comentado en color amarillo corresponde a la lógica dada en el proyecto de partida y en azul el APIREST desarrollado para interactuar con el controlador.

\imagen{DiagramPaqRest}{Diagrama de paquetes del APIRest}

\subsection{Aplicación Android}

En este diagrama se muestra el desglose de todos los componentes que forman la arquitectura del FrontEnd de la aplicación.


\imagen{DiagramPaqAndroid}{Diagrama de paquetes de la aplicación Android}

\section{Diseño procedimental}

\subsection{Diagrama de secuencias}

En esta sección se incluyen los diagramas de secuencias o de interacción, encargados de mostrar de una manera mas aproximada la interacción del sistema al realizar cada caso de uso.

\subsubsection{Diagrama de secuencias que implementa CU1: Iniciar sesión}

\imagen{DiagramaSecuenciaCU1}{Diagrama de secuencias caso de uso 1}

\subsubsection{Diagrama de secuencias que implementa CU2: Olvidar campos}

\subsubsection{Diagrama de secuencias que implementa CU3: Recordar campos}

\subsubsection{Diagrama de secuencias que implementa CU4: Mostrar cursos}

\subsubsection{Diagrama de secuencias que implementa CU5: Mostrar cuestionarios}

\subsubsection{Diagrama de secuencias que implementa CU6: Resolver cuestionario}

\subsubsection{Diagrama de secuencias que implementa CU7: Mostrar cuestionarios resueltos}

\subsubsection{Diagrama de secuencias que implementa CU8: Mostrar calificación de los alumnos}

\subsubsection{Diagrama de secuencias que implementa CU9: Ver cuestionarios}

\section{Diseño arquitectónico}

\subsubsection{Diagrama de despliegue}



